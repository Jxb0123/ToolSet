# é€‚é… OpenClash 
# é‡‡ç”¨ whitelist DNS æ¨¡å¼
# ä¸æ‡‚è¯·ä¸è¦ä¹±æ”¹

# ======= å…¨å±€é…ç½® =======
port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893
tproxy-port: 7894
allow-lan: true
bind-address: "*"
ipv6: false
unified-delay: true
tcp-concurrent: true
log-level: info
find-process-mode: 'off'
global-client-fingerprint: chrome
keep-alive-idle: 600
keep-alive-interval: 15
geodata-mode: true
geo-auto-update: true
geo-update-interval: 168
profile:
  store-selected: true
  store-fake-ip: true

# ======= å¤–éƒ¨æ§åˆ¶ =======
external-controller: 0.0.0.0:9090
secret: ""

# ======= å—…æ¢é…ç½® =======
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  force-domain:
    - "+.v2ex.com"
  skip-domain:
    - "+.baidu.com"

# ======= TUN é…ç½® =======
tun:
  enable: true
  stack: mixed
  dns-hijack: ["any:53", "tcp://any:53"]
  auto-route: false
  auto-redirect: false
  auto-detect-interface: false

# ======= DNS é…ç½® =======
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 28.0.0.1/8
  fake-ip-filter-mode: whitelist
  fake-ip-filter:
    - 'geosite:gfw'
    - 'geosite:proxy'
  default-nameserver:
    - 223.5.5.5
  proxy-server-nameserver:
    - https://223.5.5.5/dns-query
  nameserver:
    - 223.5.5.5
    - 119.29.29.29

# ======= ä»£ç†é…ç½® =======
proxies:

# ======= ä»£ç†æä¾›å•† =======
proxy-providers:
  AP1:
    type: http
    url: 
    path: ./proxies/AP1.yaml
    interval: 86400
    health-check:
      enable: true
      url: http://www.apple.com/library/test/success.html
      interval: 600
    override:
      additional-prefix: "[AP1]"
      
  AP2:
    type: http
    url: 
    path: ./proxies/AP2.yaml
    interval: 86400
    health-check:
      enable: true
      url: http://www.apple.com/library/test/success.html
      interval: 600
    override:
      additional-prefix: "[AP2]"
      
  AP3:
    type: http
    url: 
    path: ./proxies/AP3.yaml
    interval: 86400
    health-check:
      enable: true
      url: http://www.apple.com/library/test/success.html
      interval: 600
    override:
      additional-prefix: "[AP3]"

# ======= ä»£ç†ç»„ =======
proxy-groups:
  # åœ°åŒºèŠ‚ç‚¹ç»„
  - name: ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 600
    tolerance: 100
    filter: '^(?=.*((?i)ğŸ‡ºğŸ‡¸|ç¾å›½|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰ãƒ©|è¥¿é›…å›¾|èŠåŠ å“¥|(\b(US|United States)\b))).*$'
    include-all: true

  - name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 600
    tolerance: 100
    filter: '^(?=.*((?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|(\b(JP|Japan)\b))).*$'
    include-all: true

  - name: ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 600
    tolerance: 100
    filter: '^(?=.*((?i)ğŸ‡°ğŸ‡·|éŸ©å›½|éŸ“|é¦–å°”|(\b(KR|Korea)\b))).*$'
    include-all: true

  - name: ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 600
    tolerance: 100
    filter: '^(?=.*((?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|Singapore)\b))).*$'
    include-all: true

  - name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 600
    tolerance: 100
    filter: '^(?=.*((?i)ğŸ‡­ğŸ‡°|é¦™æ¸¯|(\b(HK|Hong)\b))).*$'
    include-all: true

  - name: ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 600
    tolerance: 100
    filter: '^(?=.*((?i)ğŸ‡¹ğŸ‡¼|å°æ¹¾|å°ç£|å°åŒ—|å°ä¸­|æ–°åŒ—|(\b(TW|Taiwan)\b))).*$'
    include-all: true

  # åŸºç¡€é€‰æ‹©ç»„
  - name: âš¡ï¸ è‡ªåŠ¨é€‰æ‹©
    type: url-test
    url: http://www.apple.com/library/test/success.html
    interval: 600
    tolerance: 100
    include-all: true

  - name: ğŸš€ æ‰‹åŠ¨é€‰æ‹©
    type: select
    include-all: true

  # æ•…éšœè½¬ç§»åˆ†ç»„
  - name: ğŸ”¯ é¦™æ¸¯æ•…è½¬
    type: fallback
    include-all: true
    tolerance: 20
    interval: 300
    filter: "(?=.*(æ¸¯|HK|(?i)Hong))^((?!(å°|æ—¥|éŸ©|æ–°|æ·±|ç¾)).)*$"

  - name: ğŸ”¯ æ—¥æœ¬æ•…è½¬
    type: fallback
    include-all: true
    tolerance: 20
    interval: 300
    filter: "(?=.*(æ—¥|JP|(?i)Japan))^((?!(æ¸¯|å°|éŸ©|æ–°|ç¾)).)*$"

  - name: ğŸ”¯ ç‹®åŸæ•…è½¬
    type: fallback
    include-all: true
    tolerance: 20
    interval: 300
    filter: "(?=.*(æ–°åŠ å¡|å¡|ç‹®åŸ|SG|Singapore))^((?!(å°|æ—¥|éŸ©|æ·±|ç¾)).)*$"

  - name: ğŸ”¯ ç¾å›½æ•…è½¬
    type: fallback
    include-all: true
    tolerance: 20
    interval: 300
    filter: "(?=.*(ç¾|US|(?i)States|America))^((?!(æ¸¯|å°|éŸ©|æ–°|æ—¥)).)*$"
    
  - name: ğŸ”¯ å°æ¹¾æ•…è½¬
    type: fallback
    include-all: true
    tolerance: 20
    interval: 300
    filter: "(?=.*(å°æ¹¾|å°ç£|TW|Taiwan))^((?!(æ¸¯|æ—¥|éŸ©|æ–°|ç¾)).)*$"

  # åº”ç”¨ä¸“ç”¨ç»„
  - name: ğŸ¤– ChatGPT
    type: select
    proxies: &common_proxies
      - ğŸ”¯ ç¾å›½æ•…è½¬
      - ğŸ”¯ æ—¥æœ¬æ•…è½¬
      - ğŸ”¯ ç‹®åŸæ•…è½¬
      - ğŸ”¯ é¦™æ¸¯æ•…è½¬
      - ğŸ”¯ å°æ¹¾æ•…è½¬
      - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹
      - âš¡ï¸ è‡ªåŠ¨é€‰æ‹©
      - ğŸš€ æ‰‹åŠ¨é€‰æ‹©
      - DIRECT

  - name: ğŸ”® Gemini
    type: select
    proxies: *common_proxies

  - name: ğŸ’» Github
    type: select
    proxies: *common_proxies
           
  - name: ğŸ“¹ Youtube
    type: select
    proxies: *common_proxies
           
  - name: ğŸ” Google
    type: select
    proxies: *common_proxies
            
  - name: ğŸ¬ Netflix
    type: select
    proxies: *common_proxies

  - name: âœˆï¸ Telegram
    type: select
    proxies: *common_proxies

  - name: ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
    type: select
    proxies: &direct_first
      - DIRECT
      - ğŸ”¯ ç¾å›½æ•…è½¬
      - ğŸ”¯ æ—¥æœ¬æ•…è½¬
      - ğŸ”¯ ç‹®åŸæ•…è½¬
      - ğŸ”¯ é¦™æ¸¯æ•…è½¬
      - ğŸ”¯ å°æ¹¾æ•…è½¬
      - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹
      - âš¡ï¸ è‡ªåŠ¨é€‰æ‹©
      - ğŸš€ æ‰‹åŠ¨é€‰æ‹©

  - name: ğŸŒ ä»£ç†ç½‘ç«™
    type: select
    proxies: *common_proxies

  - name: ğŸ® ä»£ç†æ¸¸æˆ
    type: select
    proxies: *common_proxies

  - name: ğŸ Apple
    type: select
    proxies: *direct_first
      
  - name: ğŸ’  Microsoft
    type: select
    proxies: *direct_first

  - name: ğŸŸ æ¼ç½‘ä¹‹é±¼
    type: select
    proxies: *common_proxies

# ======= è§„åˆ™é…ç½® =======
rules:
  # å¹¿å‘Šæ‹¦æˆª
  - GEOSITE,category-ads-all,REJECT

  # æœ¬åœ°/ç§æœ‰/ç‰¹æ®Šè§„åˆ™
  - GEOSITE,private,DIRECT
  - GEOIP,private,DIRECT,no-resolve
  - IP-CIDR,192.168.0.0/16,DIRECT,no-resolve
  - IP-CIDR,10.0.0.0/8,DIRECT,no-resolve
  - IP-CIDR,172.16.0.0/12,DIRECT,no-resolve
  - IP-CIDR,127.0.0.0/8,DIRECT,no-resolve

  # åº”ç”¨è§„åˆ™ 
  - DOMAIN,lf3-static.bytednsdoc.com,ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
  - DOMAIN,v5-dy-o-abtest.zjcdn.com,ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
  - DOMAIN-SUFFIX,amemv.com,ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
  - DOMAIN-SUFFIX,douyincdn.com,ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
  - DOMAIN-SUFFIX,douyinpic.com,ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
  - DOMAIN-SUFFIX,douyinstatic.com,ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
  - DOMAIN-SUFFIX,douyinvod.com,ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
  - DOMAIN-SUFFIX,idouyinvod.com,ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
  - DOMAIN-SUFFIX,ixigua.com,ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
  - DOMAIN-SUFFIX,ixiguavideo.com,ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
  - DOMAIN-SUFFIX,pstatp.com,ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
  - DOMAIN-SUFFIX,snssdk.com,ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
  - DOMAIN-SUFFIX,toutiao.com,ğŸµ æŠ–éŸ³çŸ­è§†é¢‘
  - DOMAIN-SUFFIX,manus.im,ğŸ¤– ChatGPT
  - DOMAIN-KEYWORD,manus,ğŸ¤– ChatGPT

  # å¸¸ç”¨æœåŠ¡åˆ†æµ
  - GEOSITE,telegram,âœˆï¸ Telegram
  - GEOSITE,category-ai,ğŸ¤– ChatGPT
  - GEOSITE,github,ğŸ’» Github
  - GEOSITE,netflix,ğŸ¬ Netflix
  - GEOSITE,youtube,ğŸ“¹ Youtube
  - GEOSITE,google,ğŸ” Google
  - GEOSITE,apple-cn,DIRECT 
  - GEOSITE,apple,ğŸ Apple
  - GEOSITE,microsoft-cn,DIRECT 
  - GEOSITE,microsoft,ğŸ’  Microsoft

  # ä»£ç†è§„åˆ™ (å›½å¤–ç½‘ç«™)
  - GEOSITE,gfw,ğŸŒ ä»£ç†ç½‘ç«™
  - GEOSITE,geolocation-!cn,ğŸŒ ä»£ç†ç½‘ç«™

  # ç›´è¿è§„åˆ™ (å›½å†…ç½‘ç«™)
  - GEOSITE,cn,DIRECT
  - GEOIP,cn,DIRECT,no-resolve
  
  # å…œåº•è§„åˆ™
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼